<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.yufu.cortex.dao.CortexViewAccdetStatMapper">
  <resultMap id="BaseResultMap" type="cn.yufu.cortex.entity.CortexViewAccdetStat">
    <result column="CARD_BIN" jdbcType="VARCHAR" property="cardBin" />
    <result column="CRDPRODUCT" jdbcType="VARCHAR" property="crdproduct" />
    <result column="CARD_TYPE_NAME" jdbcType="VARCHAR" property="cardTypeName" />
    <result column="CARD_STATUS" jdbcType="CHAR" property="cardStatus" />
    <result column="CARD_STATUS_NAME" jdbcType="VARCHAR" property="cardStatusName" />
    <result column="CARD_CNT" jdbcType="DECIMAL" property="cardCnt" />
    <result column="CARD_BAL" jdbcType="DECIMAL" property="cardBal" />
    <result column="TRUE_BAL" jdbcType="DECIMAL" property="trueBal" />
    <result column="INST_BAL" jdbcType="DECIMAL" property="instBal" />
    <result column="INST_BAL9" jdbcType="DECIMAL" property="instBal9" />
    <result column="TOTAL_BAL" jdbcType="DECIMAL" property="totalBal" />
    <result column="STLFLAG" jdbcType="VARCHAR" property="stlFlag" />
    <result column="ISEXCLUSIVE" jdbcType="VARCHAR" property="isExclusive" />
  </resultMap>
  <sql id="Example_Where_Clause">
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause">
    <where>
      <foreach collection="example.oredCriteria" item="criteria" separator="or">
        <if test="criteria.valid">
          <trim prefix="(" prefixOverrides="and" suffix=")">
            <foreach collection="criteria.criteria" item="criterion">
              <choose>
                <when test="criterion.noValue">
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue">
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue">
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue">
                  and ${criterion.condition}
                  <foreach close=")" collection="criterion.value" item="listItem" open="(" separator=",">
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List">
    CARD_BIN, CRDPRODUCT, CARD_TYPE_NAME, CARD_STATUS, CARD_STATUS_NAME, CARD_CNT, ISEXCLUSIVE, 
    STLFLAG,round(CARD_BAL,2) as CARD_BAL, round(TRUE_BAL,2) as TRUE_BAL,round(INST_BAL,2) as INST_BAL,
    round(INST_BAL9,2) as INST_BAL9,round(TOTAL_BAL,2) as TOTAL_BAL
  </sql>
  <select id="selectByExample" parameterType="cn.yufu.cortex.entity.CortexViewAccdetStatExample" resultMap="BaseResultMap">
    select
    <if test="example.distinct">
      example.distinct
    </if>
    <include refid="Base_Column_List" />
    from VIEW_ACCDET_STAT
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
    <if test="example.orderByClause != null">
      order by ${example.orderByClause}
    </if>
  </select>
  <delete id="deleteByExample" parameterType="cn.yufu.cortex.entity.CortexViewAccdetStatExample">
    delete from VIEW_ACCDET_STAT
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="cn.yufu.cortex.entity.CortexViewAccdetStat">
    insert into VIEW_ACCDET_STAT (CARD_BIN, CRDPRODUCT, CARD_TYPE_NAME, 
      CARD_STATUS, CARD_STATUS_NAME, CARD_CNT, 
      CARD_BAL, TRUE_BAL, INST_BAL, 
      TOTAL_BAL)
    values (#{cardBin,jdbcType=VARCHAR}, #{crdproduct,jdbcType=VARCHAR}, #{cardTypeName,jdbcType=VARCHAR}, 
      #{cardStatus,jdbcType=CHAR}, #{cardStatusName,jdbcType=VARCHAR}, #{cardCnt,jdbcType=DECIMAL}, 
      #{cardBal,jdbcType=DECIMAL}, #{trueBal,jdbcType=DECIMAL}, #{instBal,jdbcType=DECIMAL}, 
      #{totalBal,jdbcType=DECIMAL})
  </insert>
  <insert id="insertSelective" parameterType="cn.yufu.cortex.entity.CortexViewAccdetStat">
    insert into VIEW_ACCDET_STAT
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="cardBin != null">
        CARD_BIN,
      </if>
      <if test="crdproduct != null">
        CRDPRODUCT,
      </if>
      <if test="cardTypeName != null">
        CARD_TYPE_NAME,
      </if>
      <if test="cardStatus != null">
        CARD_STATUS,
      </if>
      <if test="cardStatusName != null">
        CARD_STATUS_NAME,
      </if>
      <if test="cardCnt != null">
        CARD_CNT,
      </if>
      <if test="cardBal != null">
        CARD_BAL,
      </if>
      <if test="trueBal != null">
        TRUE_BAL,
      </if>
      <if test="instBal != null">
        INST_BAL,
      </if>
      <if test="totalBal != null">
        TOTAL_BAL,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="cardBin != null">
        #{cardBin,jdbcType=VARCHAR},
      </if>
      <if test="crdproduct != null">
        #{crdproduct,jdbcType=VARCHAR},
      </if>
      <if test="cardTypeName != null">
        #{cardTypeName,jdbcType=VARCHAR},
      </if>
      <if test="cardStatus != null">
        #{cardStatus,jdbcType=CHAR},
      </if>
      <if test="cardStatusName != null">
        #{cardStatusName,jdbcType=VARCHAR},
      </if>
      <if test="cardCnt != null">
        #{cardCnt,jdbcType=DECIMAL},
      </if>
      <if test="cardBal != null">
        #{cardBal,jdbcType=DECIMAL},
      </if>
      <if test="trueBal != null">
        #{trueBal,jdbcType=DECIMAL},
      </if>
      <if test="instBal != null">
        #{instBal,jdbcType=DECIMAL},
      </if>
      <if test="totalBal != null">
        #{totalBal,jdbcType=DECIMAL},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="cn.yufu.cortex.entity.CortexViewAccdetStatExample" resultType="java.lang.Integer">
    select count(*) from VIEW_ACCDET_STAT
    <if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map">
    update VIEW_ACCDET_STAT
    <set>
      <if test="record.cardBin != null">
        CARD_BIN = #{record.cardBin,jdbcType=VARCHAR},
      </if>
      <if test="record.crdproduct != null">
        CRDPRODUCT = #{record.crdproduct,jdbcType=VARCHAR},
      </if>
      <if test="record.cardTypeName != null">
        CARD_TYPE_NAME = #{record.cardTypeName,jdbcType=VARCHAR},
      </if>
      <if test="record.cardStatus != null">
        CARD_STATUS = #{record.cardStatus,jdbcType=CHAR},
      </if>
      <if test="record.cardStatusName != null">
        CARD_STATUS_NAME = #{record.cardStatusName,jdbcType=VARCHAR},
      </if>
      <if test="record.cardCnt != null">
        CARD_CNT = #{record.cardCnt,jdbcType=DECIMAL},
      </if>
      <if test="record.cardBal != null">
        CARD_BAL = #{record.cardBal,jdbcType=DECIMAL},
      </if>
      <if test="record.trueBal != null">
        TRUE_BAL = #{record.trueBal,jdbcType=DECIMAL},
      </if>
      <if test="record.instBal != null">
        INST_BAL = #{record.instBal,jdbcType=DECIMAL},
      </if>
      <if test="record.totalBal != null">
        TOTAL_BAL = #{record.totalBal,jdbcType=DECIMAL},
      </if>
    </set>
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map">
    update VIEW_ACCDET_STAT
    set CARD_BIN = #{record.cardBin,jdbcType=VARCHAR},
      CRDPRODUCT = #{record.crdproduct,jdbcType=VARCHAR},
      CARD_TYPE_NAME = #{record.cardTypeName,jdbcType=VARCHAR},
      CARD_STATUS = #{record.cardStatus,jdbcType=CHAR},
      CARD_STATUS_NAME = #{record.cardStatusName,jdbcType=VARCHAR},
      CARD_CNT = #{record.cardCnt,jdbcType=DECIMAL},
      CARD_BAL = #{record.cardBal,jdbcType=DECIMAL},
      TRUE_BAL = #{record.trueBal,jdbcType=DECIMAL},
      INST_BAL = #{record.instBal,jdbcType=DECIMAL},
      TOTAL_BAL = #{record.totalBal,jdbcType=DECIMAL}
    <if test="_parameter != null">
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <select id="selectPageByExample" parameterType="map" resultMap="BaseResultMap">
		SELECT * FROM (
		SELECT a.*, ROWNUM rn FROM(
		select
		<if test="example.distinct">
			example.distinct
		</if>
		<include refid="Base_Column_List" />
		from VIEW_ACCDET_STAT
		<if test="_parameter != null">
			<include refid="Example_Where_Clause" />
		</if>
		<if test="example.orderByClause != null">
			order by ${example.orderByClause}
		</if>)
		a
		WHERE <![CDATA[ ROWNUM <= ${endResult} ]]>)
		WHERE rn &gt; ${startResult}
  </select> 
   
  <select id="getSumAmtByExample" parameterType="cn.yufu.fs.entity.ClearStatDailyAccdetExample" resultType="java.lang.String">
    select sum(CARD_CNT) || '#' ||to_char(sum(CARD_BAL),'fm999999999999990.90')|| '#' ||to_char(sum(TRUE_BAL),'fm999999999999990.90')|| '#' ||
           to_char(sum(INST_BAL),'fm999999999999990.90')|| '#' || to_char(sum(INST_BAL9),'fm999999999999990.90')|| '#' || to_char(sum(TOTAL_BAL),'fm999999999999990.90')  as fee
      from VIEW_ACCDET_STAT 
	<if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select>  
  
  <select id="getSumAmtBakByExample" parameterType="cn.yufu.fs.entity.ClearStatDailyAccdetExample" resultType="java.lang.String">
    select sum(CARD_CNT) || '#' ||to_char(sum(TOTAL_BAL),'fm999999999999990.90')
    from VIEW_ACCDET_STAT 
	<if test="_parameter != null">
      <include refid="Example_Where_Clause" />
    </if>
  </select> 
  
</mapper>